## Configuration Drift란?

---

Configuration Drift는 시스템 설정이 초기에 정의된 상태나 다른 시스템의 설정에서 점차 벗어나는 현상을 말합니다.
이는 관리자의 인간적 오류, 잘못된 자동화, 미사용 환경 설정 변경 등으로 인해 발생할 수 있습니다.

### Immutable Infrastructur

---

Immutable Infrastructure의 핵심 아이디어는 서버나 서비스의 인스턴스를 '변경 불가능'하게 만드는 것입니다.
이는 일반적으로 서버나 서비스의 상태를 나타내는 '이미지'를 사용하여 구현됩니다.

Immutable Infrastructure는 Configuration Drift를 방지하기 위한 가장 효과적인 방법입니다.

- Immutable Infrastructure는 서버가 설치된 이후 절대 변경되지 않는 형태의 인프라 패러다임입니다.
- 운영 환경에 한 번 설치된 서버는 절대 변하지 않습니다.
- 서버 업그레이드가 필요할 때는 폐기하고 다시 만들기 때문에 업그레이드가 필요 없습니다.
- 서버를 항상 깨끗하게 유지하므로 Configuration Drift 현상을 방지할 수 있습니다.

Immutable Infrastructure는 애완 동물과 가축에 대한 비유로 설명할 수 있습니다.

애완 동물은 이름을 붙여주고 아프면 병원에 데리고 가고, 가족처럼 보살펴 줍니다.
하지만 가축은 이름이 아닌 태그를 붙이고 전염병이 있으면 처분하게 됩니다.

### Immutable Infrastructure의 장단점

---

### Immutable Infrastructure의 장점

- 일관성 : 모든 서버는 동일한 이미지에서 생성되므로, 시스템의 일관성을 유지할 수 있습니다.
- 신뢰성 : 서버는 한 번 설정되면 변경되지 않으므로, 예기치 않은 문제나 설정 변동에 의한 오류가 줄어듭니다.
- 효율적인 롤백 : 문제가 발생하면, 이전 버전의 이미지로 쉽게 롤백할 수 있습니다.
  - 이는 각각의 버전을 별도의 이미지로 관리하기 때문.

단점으로는

- 저장 공간 사용량 증가 : 각 배포마다 새로운 이미지를 생성하므로, 저장 공간이 점점 증가할 수 있습니다.
- stateful 애플리케이션 문제 : Immutable Infrastructure는 서버 업그레이드가 필요할 때, 폐기하고 다시 만들기 때문에 stateful 애플리케이션 관리가 힘들 수 있습니다.
- 비용 : 새로운 인스턴스를 계속 생성하고 폐기하는 것은 비용적인 측면에서 비효율적일 수 있습니다.
- 폐기 과정 관리 : 서버를 폐기할 때, 중요한 데이터가 삭제되지 않도록 관리하는 추가적인 복잡성이 있습니다.

stateful 애플리케이션 문제 및 폐기 과정 관리 문제는 **_격리된 DB사용으로_**해결할 수 있습니다.

애플리케이션 데이터를 격리된 DB에 보관함으로써 애플리케이션의 상태가 유지되도록 할 수 있습니다.
즉, 애플리케이션의 인스턴스를 교체하더라도 DB는 영향을 받지 않으며, 새로운 인스턴스도 동일한 데이터에 접근할 수 있습니다.

애플리케이션 인스턴스를 폐기해도 DB는 영향을 받지 않기 때문에, 중요한 데이터가 삭제되는 것을 방지할 수 있습니다.
인스턴스를 새로 만들거나 교체할 때마다 DB와의 연결을 재설정하면 됩니다.
