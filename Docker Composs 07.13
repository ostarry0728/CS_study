### **도커 컴포즈란?**

**도커 컴포즈(Docker Compose)는 도커(Docker)를 사용하여 멀티 컨테이너 애플리케이션을 정의하고 실행하기 위한 도구입니다.**

### **도커 컴포즈의 필요성?**

### 🔥 **실행 명령어를 일일이 입력하기 복잡해서**

**nginx 컨테이너를 실행하기 위해서는 예를들어 아래와 같은 명령어를 사용할 수 있습니다.**

```docker
$ docker run -it nginx
```

**하지만 위 명령어 만으로는 nignx의 특성상 port를 붙여주지 않으면 사용할 수 없습니다.** 

```docker
$ docker run -it -p 8080:80 nginx
```

**위와 같이 port를 지정해줘야 합니다.**

**또 컨테이너를 종료시켰을 때, docker ps -a 명령을 치면 컨테이너가 종료된 채로 남아있습니다. 종료가 된 후 자동으로 삭제되게 하려면 아래와 같이 --rm 옵션을 붙여줘야 합니다.**

```docker
$ docker run -it -p 8080:80 --rm nginx
```

**위와 같이 옵션이 하나씩 추가될 때 마다 명령어가 계속해서 늘어나기 때문에 점점 복잡하고 번거로워 집니다.**

**그렇기에 docker composs 를 이용하여 명령을 짧고 간결하게 사용할 수 있습니다.**

### 🔥 컨테이너끼리 연결을 편하게 하기 위해서

아래 정보들은 타 블로그에서 발췌 해왔습니다.

**github에서 django 소스를 내려받고, 이를 컨테이너 시키기 위해 아래 처럼 build 할 수 있습니다.**

```docker
$ docker build -t django-sample .
```

**이제 django 컨테이너를 실행하고, DB로 postgres 컨테이너를 실행해보면**

```docker
$ docker run --rm -d --name django -p 8000:8000 django-sample
```

```docker
$ docker run --rm -d --name postgres -e POSTGRES_DB=djangosample -e POSTGRES_USER=sampleuser -e POSTGRES_PASSWORD=samplesecret postgres
```

**django 컨테이너와 postgres 컨테이너가 실행되었지만, django에서 DB를 못찾고 있기 때문에 에러가 발생합니다.**

**이럴땐, 먼저 DB를 컨테이너화 시킨 뒤,  django를 컨테이너화 시킬 때  --link 옵션으로 연결해줄 수 있습니다.**

```docker
$ docker run --rm -d --name postgres -e POSTGRES_DB=djangosample -e POSTGRES_USER=sampleuser -e POSTGRES_PASSWORD=samplesecret postgres
```

```docker
$ docker run -d --rm -p 8000:8000 -e DJANGO_DB_HOST=db --link postgres:db django-sample
```

**django를 run할 때,  -e 옵션으로 db를 지정해주고 --link 옵션으로 연결해주었기 때문에 서버가 잘 실행될 수 있습니다. 하지만, 하나의 컨테이너의 경우 한번으로 간단하지만 여기에 더 많은 컨테이너가 있다고 하면 매번 이렇게 run 시키는 것이 불편하고 연결이 문제가 발생합니다.**

**위 처럼 django와 postgres만 연결하는데도 여러 명령어 뿐 아니라 여러가지 옵션을 사용해야 합니다. 여기에 더해 bridge도 만들어 줘야 합니다. 너무 복잡하죠.**

**이러한 작업을 반복적으로 할 필요없이 문서로 관리할 수 있게 해주는 것이 docker-compose 입니다.**

**아래는 docker coposs 실행 명령어입니다.**

```docker
$ docker-compose up -d
```

```docker
$ docker-compose down
```

**docker-compse는 yml 파일을 생성하여 위의 여러 설정을 모두 담음으로써, 위의 간단한 명령으로 docker를 실행시킬 수 있습니다.**
